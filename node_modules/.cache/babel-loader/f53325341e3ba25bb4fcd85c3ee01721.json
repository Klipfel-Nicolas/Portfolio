{"ast":null,"code":"/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n * @author mrdoob / http://mrdoob.com/\n */\nvar THREE = require('three');\n\nfunction CSS3DObject(element) {\n  THREE.Object3D.call(this);\n  this.element = element;\n  this.element.style.position = 'absolute';\n  this.addEventListener('removed', function () {\n    if (this.element.parentNode !== null) {\n      this.element.parentNode.removeChild(this.element);\n    }\n  });\n}\n\n;\nCSS3DObject.prototype = Object.create(THREE.Object3D.prototype);\nCSS3DObject.prototype.constructor = CSS3DObject;\nmodule.exports.CSS3DObject = CSS3DObject;\n\nCSS3DSprite = function (element) {\n  CSS3DObject.call(this, element);\n};\n\nCSS3DSprite.prototype = Object.create(CSS3DObject.prototype);\nCSS3DSprite.prototype.constructor = CSS3DSprite;\nmodule.exports.CSS3DSprite = CSS3DSprite; //\n\nfunction CSS3DRenderer() {\n  var _width, _height;\n\n  var _widthHalf, _heightHalf;\n\n  var matrix = new THREE.Matrix4();\n  var cache = {\n    camera: {\n      fov: 0,\n      style: ''\n    },\n    objects: {}\n  };\n  var domElement = document.createElement('div');\n  domElement.style.overflow = 'hidden';\n  this.domElement = domElement;\n  var cameraElement = document.createElement('div');\n  cameraElement.style.WebkitTransformStyle = 'preserve-3d';\n  cameraElement.style.MozTransformStyle = 'preserve-3d';\n  cameraElement.style.transformStyle = 'preserve-3d';\n  domElement.appendChild(cameraElement);\n  var isIE = /Trident/i.test(navigator.userAgent);\n\n  this.setClearColor = function () {};\n\n  this.getSize = function () {\n    return {\n      width: _width,\n      height: _height\n    };\n  };\n\n  this.setSize = function (width, height) {\n    _width = width;\n    _height = height;\n    _widthHalf = _width / 2;\n    _heightHalf = _height / 2;\n    domElement.style.width = width + 'px';\n    domElement.style.height = height + 'px';\n    cameraElement.style.width = width + 'px';\n    cameraElement.style.height = height + 'px';\n  };\n\n  function epsilon(value) {\n    return Math.abs(value) < 1e-10 ? 0 : value;\n  }\n\n  function getCameraCSSMatrix(matrix) {\n    var elements = matrix.elements;\n    return 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(-elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(elements[6]) + ',' + epsilon(elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(-elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(-elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n  }\n\n  function getObjectCSSMatrix(matrix, cameraCSSMatrix) {\n    var elements = matrix.elements;\n    var matrix3d = 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(-elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(-elements[6]) + ',' + epsilon(-elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n\n    if (isIE) {\n      return 'translate(-50%,-50%)' + 'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)' + cameraCSSMatrix + matrix3d;\n    }\n\n    return 'translate(-50%,-50%)' + matrix3d;\n  }\n\n  function renderObject(object, camera, cameraCSSMatrix) {\n    if (object instanceof CSS3DObject) {\n      var style;\n\n      if (object instanceof CSS3DSprite) {\n        // http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n        matrix.copy(camera.matrixWorldInverse);\n        matrix.transpose();\n        matrix.copyPosition(object.matrixWorld);\n        matrix.scale(object.scale);\n        matrix.elements[3] = 0;\n        matrix.elements[7] = 0;\n        matrix.elements[11] = 0;\n        matrix.elements[15] = 1;\n        style = getObjectCSSMatrix(matrix, cameraCSSMatrix);\n      } else {\n        style = getObjectCSSMatrix(object.matrixWorld, cameraCSSMatrix);\n      }\n\n      var element = object.element;\n      var cachedStyle = cache.objects[object.id] && cache.objects[object.id].style;\n\n      if (cachedStyle === undefined || cachedStyle !== style) {\n        element.style.WebkitTransform = style;\n        element.style.MozTransform = style;\n        element.style.transform = style;\n        cache.objects[object.id] = {\n          style: style\n        };\n\n        if (isIE) {\n          cache.objects[object.id].distanceToCameraSquared = getDistanceToSquared(camera, object);\n        }\n      }\n\n      if (element.parentNode !== cameraElement) {\n        cameraElement.appendChild(element);\n      }\n    }\n\n    for (var i = 0, l = object.children.length; i < l; i++) {\n      renderObject(object.children[i], camera, cameraCSSMatrix);\n    }\n  }\n\n  var getDistanceToSquared = function () {\n    var a = new THREE.Vector3();\n    var b = new THREE.Vector3();\n    return function (object1, object2) {\n      a.setFromMatrixPosition(object1.matrixWorld);\n      b.setFromMatrixPosition(object2.matrixWorld);\n      return a.distanceToSquared(b);\n    };\n  }();\n\n  function zOrder(scene) {\n    var order = Object.keys(cache.objects).sort(function (a, b) {\n      return cache.objects[a].distanceToCameraSquared - cache.objects[b].distanceToCameraSquared;\n    });\n    var zMax = order.length;\n    scene.traverse(function (object) {\n      var index = order.indexOf(object.id + '');\n\n      if (index !== -1) {\n        object.element.style.zIndex = zMax - index;\n      }\n    });\n  }\n\n  this.render = function (scene, camera) {\n    var fov = camera.projectionMatrix.elements[5] * _heightHalf;\n\n    if (cache.camera.fov !== fov) {\n      domElement.style.WebkitPerspective = fov + 'px';\n      domElement.style.MozPerspective = fov + 'px';\n      domElement.style.perspective = fov + 'px';\n      cache.camera.fov = fov;\n    }\n\n    scene.updateMatrixWorld();\n    if (camera.parent === null) camera.updateMatrixWorld();\n    var cameraCSSMatrix = 'translateZ(' + fov + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse);\n    var style = cameraCSSMatrix + 'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n    if (cache.camera.style !== style && !isIE) {\n      cameraElement.style.WebkitTransform = style;\n      cameraElement.style.MozTransform = style;\n      cameraElement.style.transform = style;\n      cache.camera.style = style;\n    }\n\n    renderObject(scene, camera, cameraCSSMatrix);\n\n    if (isIE) {\n      // IE10 and 11 does not support 'preserve-3d'.\n      // Thus, z-order in 3D will not work.\n      // We have to calc z-order manually and set CSS z-index for IE.\n      // FYI: z-index can't handle object intersection\n      zOrder(scene);\n    }\n  };\n}\n\n;\nCSS3DRenderer.prototype = Object.create(THREE.EventDispatcher.prototype);\nCSS3DRenderer.prototype.constructor = CSS3DRenderer;\nmodule.exports.CSS3DRenderer = CSS3DRenderer;","map":{"version":3,"sources":["/Users/klipfelnicolas/Desktop/dossier web/ProjetGit/Portfolio/client/node_modules/three-css3drenderer/index.js"],"names":["THREE","require","CSS3DObject","element","Object3D","call","style","position","addEventListener","parentNode","removeChild","prototype","Object","create","constructor","module","exports","CSS3DSprite","CSS3DRenderer","_width","_height","_widthHalf","_heightHalf","matrix","Matrix4","cache","camera","fov","objects","domElement","document","createElement","overflow","cameraElement","WebkitTransformStyle","MozTransformStyle","transformStyle","appendChild","isIE","test","navigator","userAgent","setClearColor","getSize","width","height","setSize","epsilon","value","Math","abs","getCameraCSSMatrix","elements","getObjectCSSMatrix","cameraCSSMatrix","matrix3d","renderObject","object","copy","matrixWorldInverse","transpose","copyPosition","matrixWorld","scale","cachedStyle","id","undefined","WebkitTransform","MozTransform","transform","distanceToCameraSquared","getDistanceToSquared","i","l","children","length","a","Vector3","b","object1","object2","setFromMatrixPosition","distanceToSquared","zOrder","scene","order","keys","sort","zMax","traverse","index","indexOf","zIndex","render","projectionMatrix","WebkitPerspective","MozPerspective","perspective","updateMatrixWorld","parent","EventDispatcher"],"mappings":"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","sourcesContent":["/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar THREE = require('three');\n\nfunction CSS3DObject ( element ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.element = element;\n\tthis.element.style.position = 'absolute';\n\n\tthis.addEventListener( 'removed', function () {\n\n\t\tif ( this.element.parentNode !== null ) {\n\n\t\t\tthis.element.parentNode.removeChild( this.element );\n\n\t\t}\n\n\t} );\n\n};\n\n\nCSS3DObject.prototype = Object.create( THREE.Object3D.prototype );\nCSS3DObject.prototype.constructor = CSS3DObject;\nmodule.exports.CSS3DObject = CSS3DObject;\n\nCSS3DSprite = function ( element ) {\n\n\tCSS3DObject.call( this, element );\n\n};\n\nCSS3DSprite.prototype = Object.create( CSS3DObject.prototype );\nCSS3DSprite.prototype.constructor = CSS3DSprite;\nmodule.exports.CSS3DSprite = CSS3DSprite;\n\n//\n\nfunction CSS3DRenderer () {\n\n\tvar _width, _height;\n\tvar _widthHalf, _heightHalf;\n\n\tvar matrix = new THREE.Matrix4();\n\n\tvar cache = {\n\t\tcamera: { fov: 0, style: '' },\n\t\tobjects: {}\n\t};\n\n\tvar domElement = document.createElement( 'div' );\n\tdomElement.style.overflow = 'hidden';\n\n\tthis.domElement = domElement;\n\n\tvar cameraElement = document.createElement( 'div' );\n\n\tcameraElement.style.WebkitTransformStyle = 'preserve-3d';\n\tcameraElement.style.MozTransformStyle = 'preserve-3d';\n\tcameraElement.style.transformStyle = 'preserve-3d';\n\n\tdomElement.appendChild( cameraElement );\n\n\tvar isIE = /Trident/i.test( navigator.userAgent );\n\n\tthis.setClearColor = function () {};\n\n\tthis.getSize = function () {\n\n\t\treturn {\n\t\t\twidth: _width,\n\t\t\theight: _height\n\t\t};\n\n\t};\n\n\tthis.setSize = function ( width, height ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\t\t_widthHalf = _width / 2;\n\t\t_heightHalf = _height / 2;\n\n\t\tdomElement.style.width = width + 'px';\n\t\tdomElement.style.height = height + 'px';\n\n\t\tcameraElement.style.width = width + 'px';\n\t\tcameraElement.style.height = height + 'px';\n\n\t};\n\n\tfunction epsilon( value ) {\n\n\t\treturn Math.abs( value ) < 1e-10 ? 0 : value;\n\n\t}\n\n\tfunction getCameraCSSMatrix( matrix ) {\n\n\t\tvar elements = matrix.elements;\n\n\t\treturn 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( - elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( elements[ 6 ] ) + ',' +\n\t\t\tepsilon( elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( - elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( - elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t}\n\n\tfunction getObjectCSSMatrix( matrix, cameraCSSMatrix ) {\n\n\t\tvar elements = matrix.elements;\n\t\tvar matrix3d = 'matrix3d(' +\n\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\tepsilon( elements[ 1 ] ) + ',' +\n\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\tepsilon( - elements[ 4 ] ) + ',' +\n\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\tepsilon( - elements[ 6 ] ) + ',' +\n\t\t\tepsilon( - elements[ 7 ] ) + ',' +\n\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\tepsilon( elements[ 9 ] ) + ',' +\n\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\tepsilon( elements[ 13 ] ) + ',' +\n\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\tepsilon( elements[ 15 ] ) +\n\t\t')';\n\n\t\tif ( isIE ) {\n\n\t\t\treturn 'translate(-50%,-50%)' +\n\t\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)' +\n\t\t\t\tcameraCSSMatrix +\n\t\t\t\tmatrix3d;\n\n\t\t}\n\n\t\treturn 'translate(-50%,-50%)' + matrix3d;\n\n\t}\n\n\tfunction renderObject( object, camera, cameraCSSMatrix ) {\n\n\t\tif ( object instanceof CSS3DObject ) {\n\n\t\t\tvar style;\n\n\t\t\tif ( object instanceof CSS3DSprite ) {\n\n\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\n\t\t\t\tmatrix.copy( camera.matrixWorldInverse );\n\t\t\t\tmatrix.transpose();\n\t\t\t\tmatrix.copyPosition( object.matrixWorld );\n\t\t\t\tmatrix.scale( object.scale );\n\n\t\t\t\tmatrix.elements[ 3 ] = 0;\n\t\t\t\tmatrix.elements[ 7 ] = 0;\n\t\t\t\tmatrix.elements[ 11 ] = 0;\n\t\t\t\tmatrix.elements[ 15 ] = 1;\n\n\t\t\t\tstyle = getObjectCSSMatrix( matrix, cameraCSSMatrix );\n\n\t\t\t} else {\n\n\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld, cameraCSSMatrix );\n\n\t\t\t}\n\n\t\t\tvar element = object.element;\n\t\t\tvar cachedStyle = cache.objects[ object.id ] && cache.objects[ object.id ].style;\n\n\t\t\tif ( cachedStyle === undefined || cachedStyle !== style ) {\n\n\t\t\t\telement.style.WebkitTransform = style;\n\t\t\t\telement.style.MozTransform = style;\n\t\t\t\telement.style.transform = style;\n\n\t\t\t\tcache.objects[ object.id ] = { style: style };\n\n\t\t\t\tif ( isIE ) {\n\n\t\t\t\t\tcache.objects[ object.id ].distanceToCameraSquared = getDistanceToSquared( camera, object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( element.parentNode !== cameraElement ) {\n\n\t\t\t\tcameraElement.appendChild( element );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\trenderObject( object.children[ i ], camera, cameraCSSMatrix );\n\n\t\t}\n\n\t}\n\n\tvar getDistanceToSquared = function () {\n\n\t\tvar a = new THREE.Vector3();\n\t\tvar b = new THREE.Vector3();\n\n\t\treturn function ( object1, object2 ) {\n\n\t\t\ta.setFromMatrixPosition( object1.matrixWorld );\n\t\t\tb.setFromMatrixPosition( object2.matrixWorld );\n\n\t\t\treturn a.distanceToSquared( b );\n\n\t\t};\n\n\t}();\n\n\tfunction zOrder( scene ) {\n\n\t\tvar order = Object.keys( cache.objects ).sort( function ( a, b ) {\n\n\t\t\treturn cache.objects[ a ].distanceToCameraSquared - cache.objects[ b ].distanceToCameraSquared;\n\n\t\t} );\n\t\tvar zMax = order.length;\n\n\t\tscene.traverse( function ( object ) {\n\n\t\t\tvar index = order.indexOf( object.id + '' );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tobject.element.style.zIndex = zMax - index;\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tvar fov = camera.projectionMatrix.elements[ 5 ] * _heightHalf;\n\n\t\tif ( cache.camera.fov !== fov ) {\n\n\t\t\tdomElement.style.WebkitPerspective = fov + 'px';\n\t\t\tdomElement.style.MozPerspective = fov + 'px';\n\t\t\tdomElement.style.perspective = fov + 'px';\n\n\t\t\tcache.camera.fov = fov;\n\n\t\t}\n\n\t\tscene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tvar cameraCSSMatrix = 'translateZ(' + fov + 'px)' +\n\t\t\tgetCameraCSSMatrix( camera.matrixWorldInverse );\n\n\t\tvar style = cameraCSSMatrix +\n\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n\t\tif ( cache.camera.style !== style && ! isIE ) {\n\n\t\t\tcameraElement.style.WebkitTransform = style;\n\t\t\tcameraElement.style.MozTransform = style;\n\t\t\tcameraElement.style.transform = style;\n\n\t\t\tcache.camera.style = style;\n\n\t\t}\n\n\t\trenderObject( scene, camera, cameraCSSMatrix );\n\n\t\tif ( isIE ) {\n\n\t\t\t// IE10 and 11 does not support 'preserve-3d'.\n\t\t\t// Thus, z-order in 3D will not work.\n\t\t\t// We have to calc z-order manually and set CSS z-index for IE.\n\t\t\t// FYI: z-index can't handle object intersection\n\t\t\tzOrder( scene );\n\n\t\t}\n\n\t};\n\n};\n\nCSS3DRenderer.prototype = Object.create( THREE.EventDispatcher.prototype );\nCSS3DRenderer.prototype.constructor = CSS3DRenderer;\nmodule.exports.CSS3DRenderer = CSS3DRenderer;\n"]},"metadata":{},"sourceType":"script"}